---
import Navigation from '../layout/Navigation.astro';
import HeaderNavigation from '../layout/HeaderNavigation.astro';
import Layout from '../../layouts/Layout.astro';
import ContentHeader from './ContentHeader.astro';
import ContentMeta from './ContentMeta.astro';
import ContentActions from './ContentActions.astro';
import type { WorkMeta, BlogMeta, ProjectMeta } from './ContentMeta.astro';
import '../../styles/content-prose.css';

export interface Props {
  title: string;
  type: 'work' | 'blog' | 'project';
  meta?: WorkMeta | BlogMeta | ProjectMeta;
  backLink?: {
    href: string;
    label: string;
  };
  nextActions?: Array<{
    href: string;
    label: string;
    primary?: boolean;
  }>;
  contentClass?: string;
}

const {
  title,
  type,
  meta = {},
  backLink = { href: '/', label: 'Back to Home' },
  nextActions = [],
  contentClass = ''
} = Astro.props;

// Default next actions based on content type
const defaultNextActions = {
  work: [
    { href: '/#work', label: 'Back to Work' },
    { href: '/#connect', label: 'Get in Touch', primary: true }
  ],
  blog: [
    { href: '/#thoughts', label: 'Back to Thoughts' },
    { href: '/#connect', label: 'Get in Touch', primary: true }
  ],
  project: [
    { href: '/projects', label: 'All Projects' },
    { href: '/#connect', label: 'Get in Touch', primary: true }
  ]
};

const actions = nextActions.length > 0 ? nextActions : defaultNextActions[type];

// Determine current page context for header navigation
const pageContext = {
  work: 'Work Experience',
  blog: 'Blog Post',
  project: ''
};
---

<Layout title={`${title} | Portfolio`}>
  <div class="min-h-screen bg-background text-foreground">
    <HeaderNavigation currentPage={pageContext[type]} containerType="full" />
    <Navigation containerType="full" />

    <main class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-16 sm:py-20">
      <ContentHeader title={title} type={type} backLink={backLink}>
        <ContentMeta type={type} meta={meta} />
      </ContentHeader>

      <!-- Content -->
      <article class={`max-w-none content-prose ${type}-content ${contentClass}`}>
        <slot />
      </article>

      <ContentActions actions={actions} />
    </main>
  </div>
</Layout>